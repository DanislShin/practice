<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Be Verb Practice (Present/Past)</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <style>
    :root {
      --present: #4285f4;
      --past: #ea4335;
    }
    body {
      font-family: 'Noto Sans KR', sans-serif;
      max-width: 1000px;
      margin: auto;
      padding: 20px;
      line-height: 1.7;
      color: #333;
    }
    h1, h2 {
      color: #202124;
      border-bottom: 2px solid #4285f4;
      padding-bottom: 10px;
    }
    h2 { margin-top: 30px; }
    button {
      margin: 5px 5px 10px 0;
      padding: 8px 15px;
      background-color: #4285f4;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9em;
    }
    .tense-section {
      background: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 25px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    .sentence-block {
      padding: 12px;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      background: white;
      margin: 8px 0;
      position: relative;
    }
    .tense-label {
      display: inline-block;
      padding: 4px 10px;
      background: var(--tense-color);
      color: white;
      border-radius: 4px;
      font-size: 0.85em;
      font-weight: bold;
    }
    .form-label {
      display: inline-block;
      padding: 4px 8px;
      background: #5f6368;
      color: white;
      border-radius: 4px;
      font-size: 0.75em;
      margin-left: 5px;
    }
    audio { 
      display: block;
      margin: 10px 0;
      width: 100%;
    }
    .translation {
      margin-top: 8px;
      padding: 8px;
      background: #e8f0fe;
      border-radius: 4px;
      font-size: 0.9em;
    }
    .hidden { display: none; }
    .checkmark {
      position: absolute;
      right: 12px;
      top: 12px;
      color: #34a853;
      font-size: 18px;
    }
    @media (max-width: 600px) {
      body { padding: 10px; }
      th, td { padding: 8px; }
    }
  </style>
</head>
<body>
  <h1>Be Verb Practice (Present/Past Tense)</h1>
  <button onclick="downloadAllRecordings()">üì• Download All Recordings</button>
  <div id="content"></div>

  <script>
    const grammarData = [
      // ======= ÌòÑÏû¨ ÏãúÏ†ú (Present Tense) =======
      {
        tense: "Present Tense (Be Verb)",
        color: "var(--present)",
        categories: [
          {
            title: "ÏòàÎ¨∏ 1: Ïã†Î∂Ñ",
            examples: [
              { en: "I am a student.", ko: "ÎÇòÎäî ÌïôÏÉùÏù¥Îã§.", form: "ÌèâÏÑúÎ¨∏" },
              { en: "I am not a student.", ko: "ÎÇòÎäî ÌïôÏÉùÏù¥ ÏïÑÎãàÎã§.", form: "Î∂ÄÏ†ïÎ¨∏" },
              { en: "Am I a student?", ko: "ÎÇ¥Í∞Ä ÌïôÏÉùÏù∏Í∞Ä?", form: "ÏùòÎ¨∏Î¨∏" },
              { en: "Am I not a student?", ko: "ÎÇ¥Í∞Ä ÌïôÏÉùÏù¥ ÏïÑÎãåÍ∞Ä?", form: "ÏùòÎ¨∏ Î∂ÄÏ†ïÎ¨∏" }
            ]
          },
          {
            title: "ÏòàÎ¨∏ 2: ÏÉÅÌÉú",
            examples: [
              { en: "She is happy.", ko: "Í∑∏ÎÖÄÎäî ÌñâÎ≥µÌïòÎã§.", form: "ÌèâÏÑúÎ¨∏" },
              { en: "She is not happy.", ko: "Í∑∏ÎÖÄÎäî ÌñâÎ≥µÌïòÏßÄ ÏïäÎã§.", form: "Î∂ÄÏ†ïÎ¨∏" },
              { en: "Is she happy?", ko: "Í∑∏ÎÖÄÍ∞Ä ÌñâÎ≥µÌïúÍ∞Ä?", form: "ÏùòÎ¨∏Î¨∏" },
              { en: "Is she not happy?", ko: "Í∑∏ÎÖÄÍ∞Ä ÌñâÎ≥µÌïòÏßÄ ÏïäÏùÄÍ∞Ä?", form: "ÏùòÎ¨∏ Î∂ÄÏ†ïÎ¨∏" }
            ]
          },
          {
            title: "ÏòàÎ¨∏ 3: ÏúÑÏπò",
            examples: [
              { en: "They are at home.", ko: "Í∑∏Îì§ÏùÄ ÏßëÏóê ÏûàÎã§.", form: "ÌèâÏÑúÎ¨∏" },
              { en: "They are not at home.", ko: "Í∑∏Îì§ÏùÄ ÏßëÏóê ÏûàÏßÄ ÏïäÎã§.", form: "Î∂ÄÏ†ïÎ¨∏" },
              { en: "Are they at home?", ko: "Í∑∏Îì§Ïù¥ ÏßëÏóê ÏûàÎäîÍ∞Ä?", form: "ÏùòÎ¨∏Î¨∏" },
              { en: "Are they not at home?", ko: "Í∑∏Îì§Ïù¥ ÏßëÏóê ÏûàÏßÄ ÏïäÏùÄÍ∞Ä?", form: "ÏùòÎ¨∏ Î∂ÄÏ†ïÎ¨∏" }
            ]
          }
        ]
      },

      // ======= Í≥ºÍ±∞ ÏãúÏ†ú (Past Tense) =======
      {
        tense: "Past Tense (Be Verb)",
        color: "var(--past)",
        categories: [
          {
            title: "ÏòàÎ¨∏ 1: Ïã†Î∂Ñ",
            examples: [
              { en: "I was a teacher.", ko: "ÎÇòÎäî ÍµêÏÇ¨ÏòÄÎã§.", form: "ÌèâÏÑúÎ¨∏" },
              { en: "I was not a teacher.", ko: "ÎÇòÎäî ÍµêÏÇ¨Í∞Ä ÏïÑÎãàÏóàÎã§.", form: "Î∂ÄÏ†ïÎ¨∏" },
              { en: "Was I a teacher?", ko: "ÎÇ¥Í∞Ä ÍµêÏÇ¨ÏòÄÎÇò?", form: "ÏùòÎ¨∏Î¨∏" },
              { en: "Was I not a teacher?", ko: "ÎÇ¥Í∞Ä ÍµêÏÇ¨Í∞Ä ÏïÑÎãàÏóàÎÇò?", form: "ÏùòÎ¨∏ Î∂ÄÏ†ïÎ¨∏" }
            ]
          },
          {
            title: "ÏòàÎ¨∏ 2: ÏÉÅÌÉú",
            examples: [
              { en: "He was tired.", ko: "Í∑∏Îäî ÌîºÍ≥§ÌñàÎã§.", form: "ÌèâÏÑúÎ¨∏" },
              { en: "He was not tired.", ko: "Í∑∏Îäî ÌîºÍ≥§ÌïòÏßÄ ÏïäÏïòÎã§.", form: "Î∂ÄÏ†ïÎ¨∏" },
              { en: "Was he tired?", ko: "Í∑∏Í∞Ä ÌîºÍ≥§ÌñàÎÇò?", form: "ÏùòÎ¨∏Î¨∏" },
              { en: "Was he not tired?", ko: "Í∑∏Í∞Ä ÌîºÍ≥§ÌïòÏßÄ ÏïäÏïòÎÇò?", form: "ÏùòÎ¨∏ Î∂ÄÏ†ïÎ¨∏" }
            ]
          },
          {
            title: "ÏòàÎ¨∏ 3: ÏúÑÏπò",
            examples: [
              { en: "We were in the park.", ko: "Ïö∞Î¶¨Îäî Í≥µÏõêÏóê ÏûàÏóàÎã§.", form: "ÌèâÏÑúÎ¨∏" },
              { en: "We were not in the park.", ko: "Ïö∞Î¶¨Îäî Í≥µÏõêÏóê ÏûàÏßÄ ÏïäÏïòÎã§.", form: "Î∂ÄÏ†ïÎ¨∏" },
              { en: "Were we in the park?", ko: "Ïö∞Î¶¨Í∞Ä Í≥µÏõêÏóê ÏûàÏóàÎÇò?", form: "ÏùòÎ¨∏Î¨∏" },
              { en: "Were we not in the park?", ko: "Ïö∞Î¶¨Í∞Ä Í≥µÏõêÏóê ÏûàÏßÄ ÏïäÏïòÎÇò?", form: "ÏùòÎ¨∏ Î∂ÄÏ†ïÎ¨∏" }
            ]
          }
        ]
      }
    ];

    const audioBlobs = {};
    const mediaRecorders = {};

    function playTTS(text) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = 'en-US';
      utter.rate = 0.9;
      speechSynthesis.speak(utter);
    }

    async function startRecording(tenseIndex, categoryIndex, exampleIndex) {
      const index = `${tenseIndex}-${categoryIndex}-${exampleIndex}`;
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
        const recorder = new MediaRecorder(stream);
        const chunks = [];

        recorder.ondataavailable = e => chunks.push(e.data);
        recorder.onstop = () => {
          const blob = new Blob(chunks, { type: 'audio/webm' });
          document.getElementById(`audio-${index}`).src = URL.createObjectURL(blob);
          audioBlobs[index] = blob;
          document.getElementById(`check-${index}`).innerText = '‚úÖ';
        };

        mediaRecorders[index] = recorder;
        recorder.start();
      } catch (error) {
        alert('Microphone access error: ' + error.message);
      }
    }

    function stopRecording(tenseIndex, categoryIndex, exampleIndex) {
      const index = `${tenseIndex}-${categoryIndex}-${exampleIndex}`;
      if (mediaRecorders[index] && mediaRecorders[index].state !== 'inactive') {
        mediaRecorders[index].stop();
      }
    }

    function toggle(id) {
      const el = document.getElementById(id);
      el.classList.toggle('hidden');
    }

    function downloadAllRecordings() {
      const zip = new JSZip();
      let hasRecordings = false;
      
      Object.keys(audioBlobs).forEach(key => {
        if (audioBlobs[key]) {
          const [t, c, e] = key.split('-');
          const tense = grammarData[t].tense.replace(/ /g, '_');
          const filename = `${tense}_example_${parseInt(e)+1}.webm`;
          zip.file(filename, audioBlobs[key]);
          hasRecordings = true;
        }
      });
      
      if (hasRecordings) {
        zip.generateAsync({ type: 'blob' }).then(content => {
          saveAs(content, 'be_verb_recordings.zip');
        });
      } else {
        alert('No recordings available to download.');
      }
    }

    const container = document.getElementById('content');
    
    grammarData.forEach((tenseData, tenseIndex) => {
      const tenseSection = document.createElement('div');
      tenseSection.className = 'tense-section';
      tenseSection.style.setProperty('--tense-color', tenseData.color);
      
      let tenseHTML = `
        <h2 style="border-color: ${tenseData.color}">
          <span class="tense-label" style="background: ${tenseData.color}">${tenseData.tense}</span>
        </h2>
      `;
      
      tenseData.categories.forEach((category, categoryIndex) => {
        tenseHTML += `
          <h3>${category.title}</h3>
          <table>
            <tr>
              <th width="25%">Î¨∏Ïû• Ïú†Ìòï</th>
              <th width="75%">ÏòàÎ¨∏</th>
            </tr>
        `;
        
        category.examples.forEach((example, exampleIndex) => {
          const index = `${tenseIndex}-${categoryIndex}-${exampleIndex}`;
          tenseHTML += `
            <tr>
              <td>${example.form}</td>
              <td>
                <div class="sentence-block">
                  <span id="check-${index}" class="checkmark"></span>
                  <p><strong>${example.en}</strong></p>
                  <div>
                    <button onclick="playTTS('${example.en.replace(/'/g, "\\'")}')">‚ñ∂Ô∏è Listen</button>
                    <button onclick="startRecording(${tenseIndex}, ${categoryIndex}, ${exampleIndex})">üéôÔ∏è Record</button>
                    <button onclick="stopRecording(${tenseIndex}, ${categoryIndex}, ${exampleIndex})">‚èπÔ∏è Stop</button>
                    <button onclick="toggle('trans-${index}')">üîç Translation</button>
                  </div>
                  <audio id="audio-${index}" controls></audio>
                  <div id="trans-${index}" class="hidden translation">
                    <p><strong>Korean:</strong> ${example.ko}</p>
                  </div>
                </div>
              </td>
            </tr>
          `;
        });
        
        tenseHTML += `</table>`;
      });
      
      tenseSection.innerHTML = tenseHTML;
      container.appendChild(tenseSection);
    });
  </script>
</body>
</html>